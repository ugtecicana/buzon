<!-- Uploadcare -->
<script>
  UPLOADCARE_PUBLIC_KEY = "14b5b87aed1dd83e54dc"; // tu public key válida
  UPLOADCARE_EFFECTS = "crop,enhance";
</script>
<script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.full.min.js"></script>

<div id="formulario-contenedor">
    <div class="logo-contenedor">
        <img src="logo.png" alt="Logo UGT El Corte Inglés">
    </div>

    <h1>BUZÓN ANÓNIMO</h1>

    <form id="buzon-form">
        <textarea name="mensaje" id="texto-mensaje" placeholder="Escribe aquí tu situación o propuesta..." required></textarea>

        <label style="display:block;margin-top:15px;font-weight:bold;">Adjuntar archivo (opcional)</label>
        <input type="hidden"
               role="uploadcare-uploader"
               name="archivo"
               data-tabs="file camera"
               data-multiple="false"
               data-accept="application/pdf,image/*"
               style="margin-top:10px;">

        <button type="submit" id="boton-enviar">Enviar con Seguridad Total</button>
    </form>
</div>

<script>
const formulario = document.getElementById('buzon-form');
const contenedorForm = document.getElementById('formulario-contenedor');
const mensajeExito = document.getElementById('mensaje-exito');
const boton = document.getElementById('boton-enviar');

formulario.addEventListener('submit', function(e) {
    e.preventDefault(); 
    boton.disabled = true;
    boton.innerText = "Protegiendo y enviando...";

    fetch("https://formsubmit.co/ajax/eci.laspalmas@fesmcugt.org", {
        method: "POST",
        body: new FormData(formulario),
        headers: { 'Accept': 'application/json' }
    })
    .then(r => {
        if(r.ok){
            contenedorForm.style.display='none';
            mensajeExito.style.display='block';
        } else {
            alert("Error al enviar");
            boton.disabled=false; boton.innerText="Enviar con Seguridad Total";
        }
    })
    .catch(()=>{
        alert("Error de conexión");
        boton.disabled=false; boton.innerText="Enviar con Seguridad Total";
    });
});
</script>
